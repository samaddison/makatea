# Project Makatea

## Summary
We want to develop a Python command line application using the Textual library to monitor Spring Boot applications by using Spring Boot Actuator endpoints.
We want the application to be interactive and easy to use. Users will be able to use both a mouse and the keyboard but the keyboard will provide more flexibility. We will provide many keyboard shortcuts.
The application should be able to monitor multiple Spring Boot applications. Users will enter the Spring Boot Server details, including the Spring Boot server url. This data needs to be made persistent in a file in a .makatea folder in the user home folder.
Actuator provides a large amount of information in JSON format. Simply displaying what we get in a hierarchical manner is not enough. Some of the information is very relevant and should be easily reachable, while less relevant information does not need to be displayed prominently.
Textual provides a large number of widgets. Many of them should be useful for the tool. Additionally, real time plots are preferred when possible and relevant.

## Technology
- Python 3.12
- VS Code with Claude Code
- uv
- Textual library
- Textual-Plotext libray (integration of Textual and Plotext)

## High Level Design
Conceptually, the application is divided into 3 large pieces of functionality: 
- API access to Spring Boot Actuator: a module or modules which will deal with calling the Actuator API and parsing the responses, making them available as container objects.
- Internal data management: Spring Boot does not usually retain a history of values, like metric values. To overcome this limitation, makatea will keep an in-memory history of metrics while it runs. This history will disappear when the application is restarted. The size of this history will also be limited to configurable values.
Some of the information will be static, but some other will be dynamic, like metrics, and we should keep a history. We don't need a history for static information (like the JVM version, for instance)
- The Makatea UI: interacting with the user through the UI and using the data obtained from Actuator to display the requested information.


### Spring Boot Actuator 
- There are examples of the output generated by the Actuator endpoints in format JSON under docs/actuator/json. The name of the file matches the actuator name. The url for the actuator would be /actuator/<actuator/filename>. However, bear in mind that the /actuator prefix is configurable. It will need to be entered when the user creates a new server (though /actuator should be the default value).
- If you access /actuator (HTTP GET) it will return a list of available endpoints. See format in the actuator.json file under docs/actuator/json.
- The /actuator/metrics endpoint also returns a list of available metrics. A large number of examples can be found under /docs/actuator/json/metrics where the filename reflects the metric name.
- There is a running Spring Boot application with Actuator enabled at http://localhost:9090/actuator. Please feel free to use this url as the base url for all the other actuator urls and make calls to retrieve responses in real time.

### Processing Actuator Responses
- Under src/actuator/containers, we will be creating a hierarchy of Pydantic classes which match the response JSON returned by Actuator. There is a common base class under src/actuator/containers/common called ExtraBaseModel, which should be used as the base class for every Pydantic class rather than using BaseModel directly.Then we will create a folder under src/actuator/containers with the classes for an specific Actuator endpoint. For instance, src/actuator/containers/health. We need to follow the same approach for all the other endpoints.